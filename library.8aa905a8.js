function e(e){return e&&e.__esModule?e.default:e}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},t={},a=i.parcelRequired7c6;null==a&&((a=function(e){if(e in n)return n[e].exports;if(e in t){var i=t[e];delete t[e];var a={id:e,exports:{}};return n[e]=a,i.call(a.exports,a,a.exports),a.exports}var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,i){t[e]=i},i.parcelRequired7c6=a);var s,l=a("lOKsE"),r=a("jAzyG"),o=a("eyjy7"),d=a("gKkQl"),c=a("fEVjq");function u(i){return i.map((({poster_path:i,title:n,name:t,release_date:a,first_air_date:l,genre_ids:r,genres:o,vote_average:d,id:c})=>{let u;return o&&(u=o.map((({name:e})=>e)).join(", ")),r&&(u=e(s).filter((({id:e})=>r.includes(e))).map((({name:e})=>e)).join(", ")),`<li class="films__item" data-id=${c}>\n                \n                <img class="films__img" src=https://image.tmdb.org/t/p/original${i} alt="${n||t}" loading="lazy">\n                  <div class="films__description">\n                  <p class="films__title">${n||t}</p>\n                  <p class="movie-card__additionaly">${u||"Action"}  |  ${(a||l||"2023").slice(0,4)}</p>\n                    <span class="films__rating visually-hidden">${d||"-"}</span>\n                  </div>\n                </div>\n            </li>`})).join("")}s=JSON.parse('[{"id":28,"name":"Action"},{"id":12,"name":"Adventure"},{"id":16,"name":"Animation"},{"id":35,"name":"Comedy"},{"id":80,"name":"Crime"},{"id":99,"name":"Documentary"},{"id":18,"name":"Drama"},{"id":10751,"name":"Family"},{"id":14,"name":"Fantasy"},{"id":36,"name":"History"},{"id":27,"name":"Horror"},{"id":10402,"name":"Music"},{"id":9648,"name":"Mystery"},{"id":10749,"name":"Romance"},{"id":878,"name":"Science Fiction"},{"id":10770,"name":"TV Movie"},{"id":53,"name":"Thriller"},{"id":10752,"name":"War"},{"id":37,"name":"Western"}]');const m=document.querySelector(".library__container-list");function y(e){m.innerHTML=u(e)}var f=a("2tZq5"),v=a("e4m3s"),p=a("bITeO");const h=(0,d.initializeApp)(c.firebaseConfig),g=(0,r.getDatabase)(h),_=(0,o.getAuth)(h);new(0,f.default)({queue:{},watched:{}});const L=new(0,l.API_service),b=document.querySelector("#auth"),S=document.querySelector(".js-watched"),q=document.querySelector(".js-queue"),w=document.querySelector(".library__container-list"),A=document.querySelector(".library__mes");function O(){if(S.classList.contains("current"))return;let e=p.spinerInit("body");(0,o.onAuthStateChanged)(_,(i=>{if(i){const n=`users/${i.uid}/lib/watched/`;(0,r.get)((0,r.ref)(g,n)).then((e=>{if(e.exists()){const i=Object.keys(e.val());localStorage.setItem("watched",JSON.stringify(i)),A.classList.contains("visually-hidden")||A.classList.add("visually-hidden"),j(i)}else A.classList.contains("visually-hidden")&&A.classList.remove("visually-hidden"),w.innerHTML="",console.log("No data available")})).catch((e=>{console.error(e)})),p.removeSpiner(e)}})),S.classList.add("is-active"),q.classList.remove("is-active")}async function j(e,i=1){try{let n=p.spinerInit("body");const t=20*(i-1),a=20*i,s=e.slice(t,a).map((async e=>(L.id=e,await L.fetchMovieById())));y(await Promise.all(s)),p.removeSpiner(n)}catch(e){console.log(e)}}q.addEventListener("click",(function(){if(q.classList.contains("is-active"))return;q.classList.add("is-active"),S.classList.remove("is-active");let e=p.spinerInit("body");(0,o.onAuthStateChanged)(_,(e=>{if(e){const i=`users/${e.uid}/lib/queue/`;(0,r.get)((0,r.ref)(g,i)).then((e=>{if(e.exists()){const i=Object.keys(e.val());localStorage.setItem("queued",JSON.stringify(i)),A.classList.contains("visually-hidden")||A.classList.add("visually-hidden"),j(i)}else A.classList.contains("visually-hidden")&&A.classList.remove("visually-hidden"),w.innerHTML="",console.log("No data available")})).catch((e=>{console.error(e)}))}})),p.removeSpiner(e)})),S.addEventListener("click",O),b.addEventListener("click",v.onOpenModalAuth),O();
//# sourceMappingURL=library.8aa905a8.js.map
